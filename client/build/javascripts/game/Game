((function(){var a;a=this.GEWol,a.Game=function(){function b(b){var c,d,e,f=this;this.el=b.element,this.canvas=this.el.getElementsByTagName("canvas")[0],this.canvas.width=this.el.clientWidth,this.canvas.height=this.el.clientHeight,c=new a.AssetManager,d=a.Settings.assets,e=a.Settings.settings,c.download(d,function(a){f.start()}),a.assetManager=c,a.config=e;return}return b.prototype.el=null,b.prototype.canvas=null,b.prototype.assetManager=null,b.prototype.config=null,b.prototype.background=null,b.prototype.terrain=null,b.prototype.hexes=null,b.prototype.units=null,b.prototype.hexDictionary=[],b.prototype.unitDictionary=[],b.prototype.unitList=[],b.prototype.activeUnit=null,b.prototype.start=function(){var a=this;this.stage=new Stage(this.canvas),this.events={tick:function(){a.update(),a.render()}},this.setElements(),this.addEvents(),this.test()},b.prototype.setElements=function(){var b,c,d;b=a.assetManager.get("background"),d=a.assetManager.get("terrain"),c=a.config,this.background=new Bitmap(b),this.terrain=new Bitmap(d),this.hexes=new Container,this.units=new Container,this.userInterface=new a.ui.UserInterface,this.terrain.y=c.terrainY,this.stage.addChild(this.background),this.stage.addChild(this.terrain),this.stage.addChild(this.hexes),this.stage.addChild(this.units),this.initUIEvents(),this.generateHexGrids(),this.moveTerrain(c.terrainX,c.terrainY),this.initMouseEvents(),this.addMouseEvents()},b.prototype.initUIEvents=function(){},b.prototype.initMouseEvents=function(){var a=this;this.mouseEvents={onPress:function(){a.terrain.onMouseDown=null,a.stage.onMouseUp=a.mouseEvents.onMouseUp,a.stage.onMouseMove=a.mouseEvents.onMouseMove},onMouseUp:function(){a.stage.onMouseUp=null,a.stage.onMouseMove=null},onMouseMove:function(){}}},b.prototype.addMouseEvents=function(){this.terrain.onMouseDown=null},b.prototype.moveTerrain=function(a,b){this.terrain.x=this.hexes.x=this.units.x=a,this.terrain.y=this.hexes.y=this.units.y=b},b.prototype.generateHexGrids=function(){var b,c,d,e,f,g,h,i,j,k;b=a.config,c=b.gridX,d=b.gridY,f=a.assetManager.get("hex"),k=0;while(k<d){j=0;while(j<c)e=new a.Hex({tileX:j,tileY:k,bitmap:f}),this.hexes.addChild(e.el),this.hexDictionary["x"+j+"y"+k]=e,j++;k++}h=b.tiles;for(i in h)g=h[i],e=this.getHex(g.x,g.y),e.set(g)},b.prototype.getHex=function(a,b){return this.hexDictionary["x"+a+"y"+b]},b.prototype.addEvents=function(){Ticker.useRAF=!0,Ticker.setFPS(30),Ticker.addListener(this.events)},b.prototype.update=function(){},b.prototype.render=function(){this.stage.update()},b.prototype.pause=function(){return Ticker.setPaused(!0)},b.prototype.play=function(){return Ticker.setPaused(!1)},b.prototype.test=function(){var a,b;a=this.getHex(4,3),b=this.addUnit("marine"),b.move(a),this.setUnitTurn(b.id),this.pause(),this.render()},b.prototype.addUnit=function(a,b){var c;return c=this.getUnitClass(a),c.init(),this.units.addChild(c.el),this.unitList.push(c),this.unitDictionary[c.id]=c,c},b.prototype.getUnitClass=function(b){var c;return b.match(/marine/)&&(c=new a.Marine),c},b.prototype.setUnitTurn=function(a){var b;b=this.unitDictionary[a],this.activeUnit=b,this.userInterface.showActionMenu(b)},b.prototype.showMoveTiles=function(a){var b,c;return c=this.unitDictionary[a],b=c.hex,b.show()},b}()})).call(this)